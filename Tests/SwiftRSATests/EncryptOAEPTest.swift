//
//  EncryptOAEPTest.swift
//  SwiftRSATests
//
//  Created by Leif Ibsen on 11/02/2022.
//

import XCTest

// Test vectors from Wycheproof - files
//    rsa_oaep_2048_sha256_mgf1sha256_test.json
//    rsa_oaep_3072_sha256_mgf1sha256_test.json
//    rsa_oaep_4096_sha256_mgf1sha256_test.json,
class EncryptOAEPTest: XCTestCase {

    struct testStruct {
        let msg: String
        let cipher2048: String
        let cipher3072: String
        let cipher4096: String
        let mda: RSA.MessageDigestAlgorithm
        let label: String

        init(msg: String, cipher2048: String, cipher3072: String, cipher4096: String, mda: RSA.MessageDigestAlgorithm, label: String = "") {
            self.msg = msg
            self.cipher2048 = cipher2048
            self.cipher3072 = cipher3072
            self.cipher4096 = cipher4096
            self.mda = mda
            self.label = label
        }
    }

    let privPem2048 =
"""
-----BEGIN RSA PRIVATE KEY-----
MIIEowIBAAKCAQEAorRRoH0KpfluRVZxUTVQUUqKW0YuvvcXCU+h/ugiJOY3+XRt
P3yv0xh42AMltu9aFwD2WQO0aUKeidbqyIRQl7WrOTGJ25JRLtincRoSU/rNIPec
Fegkfz0+QuRuSMmOJUov6XZTE6A+/48X4aApOXofomqNzib0kO2BKZYV2YFMItph
BCjgnH2WWFlCZvXAIdD87KCNlFoSvoLeTR7Oa0wDFFtdNJXU7VQR64eNrwX9evw+
Ca2g8RJkIvWQl1oZaYFvSGmLy7obTZyuedRg2Pn4Xnl1AF2bwixOWsD3waRdElaa
YoB9O5oC5aUw53MGb0U9H1tMLpz3ggKD90K51QIDAQABAoIBAHYn7vNWeyonJo5S
BT7NMcOnFyzLndzugZswals8ZrdXPKT6iO/G88SgC/oK5xOfZFQ6Taw9BYI/b/R3
z87IT+KsemixcgSzkCMuEQMQxOiZxOfBCWfbSs3gQtu/GdvgC0tHQd4QIKqq/7UF
THl8nxNvfZOsP8jK/2ZUJC14IevuUXv1N/RDZqD91FrgW5kJwubMHtkoHv9Dmfds
lrliM+wprgu/DXUrI0/BlzifUQUKoazQHAdMOsj7256otlGpWZXo20rVxDtshnPl
oSbn7pS43/TFr8ASWbyNp2lQuub4uucV9QmFsNb2bQTG/vO3AHIO7NzfFxu3sey+
conEZ8ECgYEA3EMQUPeC6JT7UkgkfZjLfVi40eJPO1XQQcVuTeCGsNW7AovaQu61
0jTVaB5YCdQV5qKJrUz794+Xj2w1gU9Q7r/xxbgKafeI6B5rq13ap4Np1lnRQ+xv
F+eYE6V1z62cVpFWuQET4ukRCtnntIock0im5lMyEZEpDqNs+zpbGPECgYEAvRqB
55d/mJgSInOuMiK1mOpfsZ606rw4MIpeMhlmA7LlAP+3n1uIaBZhHevEcvrEVUQH
C+sFfJQTeKaGivO3oD0/mIDsR9XgiblPveVCq6mujXLFcIjXq/WxMfOQmPe8Fg+Q
U2q8lJL9Tgbz7XKZ1Ll7sDZ3IH2VZp8UDPvCDyUCgYEAqUtSiyjykVmRIdkZUv/R
x/IdfBR52Z1HiIX7Fhhw7hIYvwhHJhLb5Ul+jZxlBojgnHhpYa4+LDVNxIrjRRR1
nEwjxFiEiJYdwGtBTmHA4ef7vSkj0xUy/iifltoiBxHljBQBmAjgBBQnaTO7B+Tv
ubSps3ZWkXIFIJ8z8JUV18ECgYA68OcqkzrvCf8lA994uv7VMcAv8aK8Q3xUDNy9
StNUNc9RF2NZZUNIBimxFMp/eA/376MuoMtuAA1tnqHy73H9nPmUhCKhZVV+N+dV
7f5w2QuSBQLrR4vJimP3iM46D4Vtbt5yUaODv6j6SAqBqSWvezzFOMS6uMn3WX/7
aAEdjQKBgCZA+/vP77Fj7nqHtkg6Zu5B+VbZD6ink5v8BC7gkksbeZPQRF91jVGT
PoUXnAMgsMlotIqRw4tb6SPhCXwMVi+I1CKUtqJ1m6+lQop08ScIdORfb8xg8hYC
3l7M0UPPMSQfWSG1rTmD+1TvF747KFNn5QyZnGcke1Uv5L/OlF97
-----END RSA PRIVATE KEY-----
"""

    let privPem3072 =
"""
-----BEGIN RSA PRIVATE KEY-----
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
-----END RSA PRIVATE KEY-----
"""

    let privPem4096 =
"""
-----BEGIN RSA PRIVATE KEY-----
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
-----END RSA PRIVATE KEY-----
"""

    let tests: [testStruct] = [
        testStruct(
            msg: "",
            cipher2048: "6e62bf24d95aff6868afec2a92a445b6458f16f688c19fe1212f66a63137831653cedd359d8cff4dd485d77dfd55812c181373201f54aafd65730d2a304e623455d51125d891e65d97fce52341cae45fb64c38a384a1c621e2713ee6794633f029a9fd4d774f56551eac2176162e162640f25eab873a3451c475570f19228bcede4c67c370a75ed7fabccd538c9819eff182481b10d42f1a9f6a05373b8cf9b71818d467bd3b8ebacb619e8ad42916e600c043effceb3855bc48a629e60ae886f51b2a7876b0e623fb2ce68af4b039242f963adb0e4240aed0ed07f65f1ee7c0cc77d210d0c2d1dc10c81b881aa0c9c9e9499665cf2970d2ccfeeb3191531765",
            cipher3072: "b47525feffb063be5201aaa1d6846f9f397589b988fa26848afb9bbd9d6b0d0c92cec327332f02bd072d53e479726faff5fb89677c4947d60d5f1d7f3bbf211755975e1851f17f0d88eb970bd14719a9e5b257cde71071915774578e0bead5f7ccd7b476732a47e0d54ef214488d733c689238f6cccd6c8be7145e0dee871fcbb504c93e1efd842b228d67fa3e303a1081e26052c6c11ca85355a2de7f717dc432a90092ff9d3d75301e7f092b3b425354939c43f0879768342242836030822c9bbbbe09d5e938fd070aac9f974c35dd46599766ac6f0f87a036a36e3650f7244a336bee4a9ed1280b8adf57d702844c739354eae88ceabd8e66338e59262ecf51b28f4dfe7bea8449383c27580f81ea06bb4bd031826e6f6ddd0c6a3c7eae23d3d6acd5f6388fd9fa70e66c86d178394953ba4e391629a9a588797e25acf8c130859cb7c9504998cce6dd9e032b1a09aba8b215b03b4343a5c0f2a8253b5543d301bd883e941786371bdad14117fa273296b153bca8ce4581df09fee1bd5e15",
            cipher4096: "48b29ff276452ebcaa7f74bbfefcaa0cbba598beca99a178594baba98b126b2679e7d64876c8fe07e39f1f3fdd5c4f664a1ab314bcb75f1e906643fc4c786d66e90cac12b8c23aef35c4727451cb033d889e2a30eecd2f8d5091a6d52170ac6ce579c9c49701461185196aec6a380e2504833609b359d33a436f2c63bfea9a70e803f06644a0ca725a4c5b9b01cec93c01cbb79f9a17c401728325e17bfc9750dd19cfc127b9dcff8951a78023b9e30ef7ab628084d04f64a4be3b6d7d3da9d0a94d692a4cb275a7f509aac8dd2db4f797a374aa880c2d646d23760c51f3e0c00601b4c05f6e618372edb7d3a6f5cc9a26b5095adbff2134450b1ba238dbb9b3952f4d055f6d486e27e8cf6ff773896a0fc2991fc5ee046f6e81cf948afb12d669cc020b3aa3f14a18cd63830964c9662fcd3860fc461694ab3c6dc4f85fb4fa527f77e944e7c13b94c23fd0fd517a30dc00212d15bb25c00d48a36db8bdbdcc398fd6b1d229c762f7bf6e99d5452f69b91b073d866884a6e34c4608ee1df0733e592e339eedd59554e85be57c0a9689b69fac6e010d35c9c823a37f6f854c5247db77d54fd784ba82ea4e3bf776413376b4bae99c02a0226abef411f1d56ba7da24b72a1a5f74ab9d7431af7fc940d2319ce81dbc51390096d42a3072291ccb44f3db326cffac084c6a73c0b92919d6039e0ddaa9fe8ab1d65aff8b22cec120",
            mda: .SHA2_256),
        testStruct(
            msg: "0000000000000000000000000000000000000000",
            cipher2048: "207180c340658b5154ae45d2e4e7326a0997c683a26b595e536a29333c4b66149af85e029d5419a39e3a147b221516ffd86b6b4b66c3e0c4c49fe8c57a2f5c37b8704b9b592b80db9cd788a4ed51ab4f0a1cbed63bd18d1f06a22f225866b0c2c417cb23473b7ba4250b1353bd2e5b4f0f937cd2efe5fa38db3c295f7748b970088657db4aa9a76e1ee6fbff166ec1861d00d085326c7384bdd1bc2f400d4f74dbdfadaf3fdc46073e668573e02030b9eb5af58eb540c66677a771194479ec0098d858a2ea45d0ba1e6b32440dfbac745000554d51a17684ca964b02a74d479f1d432ef763ef4059715a4348cfe36a215359712f25b6977903be4adb92febbf6",
            cipher3072: "4aae8595883dedea13a1fd656405ae1a94785eb86318e181b747331019087686cb81b259f864c6a524137a316f744c0d092348fe0428e1d9551bd402404342e1df33f7491c381a4f32ae5687bfae07e1c408c3e65720f54c5a168a29df6b7fbc1835fa49ed5a8b42f2acbbdefb3cf58fb6876c2a0a710bdc5c9032018c6b326389b3c32efbd7aefa8dfde0ae7bbd829e6160cef2c8632335006baad32fa7af1fc9fc3ec5ac9c4f7af226e7561cb44338d428d97886d29009989e1d875650c9f3fa8af2a0924f93d00d2cfcaae67e8a89ef34d96afba478a250b7995e7882873bec869541c02ed46b410ab75a214f0ff08ceaed4444080a4ade6baf39aaa9d9ba52487dca33759153345538143d11af5f0ca335a2a3b94e1045da7ff690a4bd454fb788bd7c73b0b16e35ec2766024fd0b7fa44e0ca01fc61e331b1fc8b09f549a946101e2b60c339304a48d044fe231288129d2b70d6b08592288d175183e442b9aa4f5ec6eac0148b6be1f989263d3cf34a7ff265539b8e34c2117b7a1c7616",
            cipher4096: "0788a1201bac2e27ee3c704ab8172cd45416bc353eddb23477841fd6e13d87b9926231315d26ccb3694064ed9c52ecf401c9be16f4e70e3d7c4eea6a2b20f32b53e94c9d26d10e60a3fc37983c4f63b46be3c04f66305c4aa23d409c9875ebf238a1d999114c9ce8644e7a93a8caf0cd006be19164508142b36000a3e3a3b8bcd445f9193ce9bc2100b4364d4c88cb5001b8fc6314cc782f469061cfa7cef3c3450121c8de529bb8d41b1cb6975698b138cf9e0460b15f10baf335cb8d680146f801de67dac74b0311059252960d59b734295f33c9f8506b6940698fb0467e746240366a49da355582831cd2d99be95057e9560c95f86931843633119218bfd2f353ffcd64983a5bcd4802acc68a0064f9da51d585c1e38310957db7373b76a3e376846614bc9271d2045fea65a6eec059cc7647c94318166fe53dd19b6e8994caf8fb0ba888f0b9b89071649299f95512c3b459ff6e3b1636c51213108c3140ce88ff377b3f36da31e85c46d5a479ddecc07899a5c175818881ea30d9a5a21b3abbbc1dfdfbd40cd6849c1312c4a89360ecbd5c1fd90c759563b0700a945bdc03a0b7888b893ed8c50149983a7e18668dcf61effd03ac8cd9d730ee55a0adfbfaad873b4b7e1923bf839a5e3df9bc634b15076379de0705150f03897142daac961c8f99a5dcbea953f2e29681546361fefa495afdb116f789ebf9815f271c55",
            mda: .SHA2_256),
        testStruct(
            msg: "54657374",
            cipher2048: "5eab3f0741e63986ed647d53e1cd71df041986900803d0f99c68355d249a15a47dc5b4f70a191477654299e5a2731f3b4eec76dea18262fc696ac794e5f66cbfcddac4472c578e246c26707598055584540b839836b1404c5611ae558a984cee8fd036cea924e0be2474a940f61e0acc14fcae95ebdc59942a9ce9af9a9c81999f7f6815f057ffdc2533cb15d6391d1e2d95f16f9c04209c889a4c359c7d2926d28a66e2b030a416b928d2825627998e5191fb4983a6e65024262d94fc09187a2d78162122433251d1bfcc8e507d06eba2d229c10031261da32ab8ccd15f1c5f9fbf07ed158483d736a110af4b44d6a4da60d6cb519b4454213cf9f0dc560f2b",
            cipher3072: "8f71391b8e3a079a51d015e86e0572aca134e5af782000545da1cbbb4cdfaf836542cad19bbc6aca73367dff9cd1e33631260d390b6d83882f82606e28abd2d8aa229ec1d93b4cf16599dfadd2178029360ef5a3bea6a136cd437f59289d334f20e7bae91ecca18b7e4fa5e3613e489ec806a52bc4727333bd7ebd5bcc7568f697d4013d0f6f54caf1baf36791fd21f8ce84643031ffe474901920eb4f592ffa306a979edfd6c287ee5b1fb0005a21d840372c60a649a1702fbc46489211700e8262bb1a2f54fd38da6a07e15850405a277705a66e7088b98bfaee8b2b51992797d5e5712147b756367170b6fde26c3fb5988ee07f916d189a3a18cdc0f3b1affe63538cbc187d4bfdcf5149b4d26bb207a1495d51a2ee1c2415f4a0d6434d50953ff2fe8480d276491ca1468e86c2318e94087e984444b04e7b804cb1f62c66573e82fa6800ac3a42ce0d8e5909f3dfba024a40c51b21b5455836a9244eeba25157e24676e1a317d1af9bf4773913ec3ba6ed1df50d3810eb98bcd290757daa",
            cipher4096: "3ee1f8fe284d3b84ecaa5f48ce36661a7842cab4f4aac4019e0e7e4506f1baa27539e468877d1e41bee136782ccd335c23640316a24fdd13e9257062fb40f102e0b482a4b589537d0e417f3db7df51c7f8a5094888981132fbc8236b79f2463b969e12c621121e697445cc80f7d0abbb31548e0b732b014b9c40b4481896c47d4d6194346f49fb8ab3c69e3a9e282a5ddab98140a798f4811b1dc4f5903f44cfe029b7038ba28d806bbd42213d5235180f33161efdc80bdd1424fee3e475dcb353f79a1fd23097f20b54afeca8d2123830e9a706bd6d827be20089a464d2df133a631db522dbc7ebddb06125c112644cc41dfc1ba6a924f7b32fc9a315626f6157aa9fdfa9979a73db2f8ee054e534b4f00235daf2fb967189720f8196986697609a45e1586fc6321a2ccaf745bcd99d69135edb45734fcd27698a87b8b3d95f426f63c5addec03201fa33ac224deb25c1cb5e1e32c7c0b895166ae10cc1b9c270a075619364650d78a2119816b17d808d44d2169022cbc5cc64f80b042ef6def97eaccac3a45c497bf2e43d823c1468167d3dc824fce8740e811c21d3e7b2289bf5c09d722edb94bcd7ac47427ce90c944279d898cd7d975d6a200ebd00104238be33bb85730c0edbd41ad4106855567be674a73b325e508483cb897cdc25aa678f0379fe121795cb858527e72c8a62dba7612104dd796d538d4d9ba80277a4",
            mda: .SHA2_256),
        testStruct(
            msg: "313233343030",
            cipher2048: "0da290b0bf71a1141b2adc62b5b42b07fc52520cb05d1f39ccca7b7c22d379a6c2f2d93143d057050140527a1e5638243938b531ec3de7014b0151301e49b9fa433482a02abdfd94193dc9c70157e557776a69ded01ecbeac405133595c61165a428b6284729a4746b47d2bbaca9d7432c3b5693591cfee488eb3c68ddb6cde0dd61cfc6952423f994abecee34f5683732b29934a2c498ad48cdd30c149177189f48eefd9cc7232df18be11ff5f7e3af7319e3115997c599e2d8f7f4f663dcc40032d403436d3058a5ea66473660f0e195281ec6eba997d2a951ca6ca5f3c112715c89da1d3dfb20a21940594ed10ade90ed7452b753757d7241cb8a803c373a",
            cipher3072: "157562f61b512b11b02d1f8299e62f55ffb9c1cb5facb33c75fee79ea8bfb68314d48a7868c05b8c97de4af54e4960868a694a3c302c73195a8acfdc78137231dc960dab44bad191c4bb2b9f8b162a73799ba2083d93c55b425f5857c925f2aea6af19514825fb18724555a5b11ef553889af38c7585c35033d1eb9b71e56ec0a1a1185e4e6e5b7aab351404f0d4a4416023449d84f3bebdf57d5666ffaea80be1958be5d7da7ad2c081aa338203516aba1e11642192aa4024e5fed6119aad7456bf13c2dd561c4ac9ac887eeaf4b53bf15e007b043de9abd6619a6fad5df35a336f744d5034af72a6ceecb9305da973c50615c29b98a8d0afa8c54f5cfe80f8efba51b08cf921cf55c69314523619e753f3056ee704a947c24d12e8817d5312ea5f6d8444da4061d26f18ab660f0eb88019506eda480195395e6e948d42e96c3ac8723f5514d87da3bc47432ab60e93efd8e6100589318f1b85d1c4bd04820be2892a8acca1e3633950b111859c6ee2063cc061a44a737ffaa2c158da806864",
            cipher4096: "0122a411f6c18869d9d071d89fec1f8d91a658d644a5da66453ad0f0fef2d07146e6a96c87dc4bc5e2d5c65cbf493289d4c9dbb3ee79dba765c71d74d8f0f0e9342f39e8621d791c813e004383fa970001c72a859ee9d01ff9920a650cdb08c11e95df70fcd3bff1f21bb4838a9534f815085238a9f860c27ad6e3075ece222d7d035732c4ed6d4d4fbc64d153da106eb58676f527e7867a7c46dd86c0f55451cfd22b07897f84621765215dd8e2814ff9d9a9cbf828d594c16ac10074689ee3472280fbc14c5f723286f2ca0f15f4b91e25559e77c244be757c18ce7743fbd0151419a1317b82407ee16e2a5b970a660706d0b4de8368ea542ea576d1c0dbcf03e07f646b42a78e430a39eaf5e48ead2d6d0cb360dbd6188d364e4a8e2b0094c698adf864724dc7098b4dda564d16edf775060eb7d26c15692878b93af87c3cf79027ebad55a08ff9f04e863d3d56dc9534d48edac17888342ab8c1bb28d8681bfae21bee0139c16ec1f6a60f2fc4927556a56c036a13e27eed7b056d5e92e296a5b7993a83f788ab0f943b56ab2622b732d717b2a6a46ceb5b9361430c8e8cc05dfdb2af949702d03a1a2b438e1612293a05ded6733e95fa17f24a06e573dd722175195e21f1f5a408ad2d72c8cc788de6d7d02da851f64a59bc64fee89eb1ffb06addb5459871a4614d6652374ed29811d3ecbb04a6646dc261e8aac5f109",
            mda: .SHA2_256),
        testStruct(
            msg: "61",
            cipher2048: "7ae8e4f5494393be144d81517f11baf4b634bb68b2f0ea9b30731035e8cbf4283c0ca99120f60b75ef685e989fecd7a5dc524cb66292a0ab87ebc61e67baca1a8aed99350edee045dfdd029406acb707d85dec9555169cf7ec5118d8f29d182f205e2859a8dcc5122bed640ad0ef128deb21785efaa20f92067dc216cf40c15bd7130e2c094131917950a816da814c5990fa6beed709a0218f4ddca2473796e1b44cff6d7ed601c574a784d0865d3afe5fec023ebe71bca881da5637e3d1d17238c20a5bd0075bac018f07898f74b9e6dc0fa3d5f8d0b274dfef3e6720d8396b34a81ac2e64da5b3e5d7666323ed7c56e8bdd179f3c6b2cf05bcac402513dd87",
            cipher3072: "76efadf7cc972062cddb8c0eb6789d1422632751dbfd514d3e8a4cfaeb17e07d78244aba11bd078fa4fe3da077f1b6b2a6bb161dffc4d96245b6d24acbddb56a2245146699ef629a069d73ea233dc3994f93bdbc208f6f53d4d74e47cc0ac167ca7912c915842d9113e75da6b2492608412e7fc2a577fd3621a1107c1d1c5e74d3a0aac4cfbf389c88474aa37be31d18fcad2f750c1b176f2c1ff544f5d23fd3e1a3c4507e62d5a2c2e0fb1bb426f860f84c4de0a2ac63f90e3a6e266504389e96b37a16ac03fff70f3bc4488b3ef783bea505911512b7d04abee4ce52b0100727e563f8416e9c6f889e5436b27388cd6d7c4e2ffda6896688f8ce15167e8baff14ce9ab95caee52a5fdc51515fca66b646af8aee83e0aed730bbf2af2a966f330818dc33d4662e4dffd50025cbf77efe6ffb3c6cfa24420f55a418d08b675dd85f7aba3da35cbadd290482af1e7a0c2b7034a41bc28a5e3dc2c47e78fb46ef14dc4674c65f5cacd17e4f542a9b98ec268bc977eb97045f50c714ad7a49c0e84",
            cipher4096: "185bdb913b9dee3ba4d6b27a945258beb43ae70909b6f5a2011256c1a743a6e2e14dad48a92ef6cbe1452306c5dbc77266590476febcce9eb6f64ec7e8d0f233749770275271e79c1980a247c0571dabf207b9d9afe8b6c3ad6f6c5b77c83f445cadbd77c043d5428acd6a55f6104c102240bfb9bd9e82d6db53547abc11537188ffce7d688b116527992f2501ae917f7aebbce1c402693c32ec29611afe7b6709667a65a6b38a6029a6ea884a7659353c29f49398de3c16e6d06e33dd186b14e7e04660c7d864954efe5c9157f178b4b9af46f12bf5fb083bbefeab1fc97114d45f08ff8389e93945afdb56a13eb3a86c64a8b33ee46349289cae37cb4f0b9ddbc306464b7574dfcea969398e6d8720125aa72fa7513ce8cf11502444594012024345e3bc716639cc1814ed18d14eee2251d20464a43bd018a9243dfc8e1d122f1d84664bf1d7e2b63236c3991929fe20d44030d17be9990e11cebfd07836e7ba4e7fa960d88cbbd23859135d2e7359a85e99e1fbb8e97ec736bb9ededf2eaa94c3165c46cdb5e289fe4b243e8e25f3969a39b307840990eef3d8b0db5d515e65833fdd59cf83c152e06f9a066623cba2fbbe233541121295566c0f2ac6150fc0efd89e2cdf7b0972a5efb7302b078816279069ad2e89016cc82add02f9aaacbc26af2cb8494d333c6e33f29a9e237df6dfb5c8e5bd8868c3a66a02bce69e9b",
            mda: .SHA2_256),
        testStruct(
            msg: "e0e1e2e3e4e5e6e7e8e9eaebecedeeeff0f1f2f3f4f5f6f7f8f9fafbfcfdfeff",
            cipher2048: "096958786ee7972050d67a9e4b69d6c6af7db7cc674386df725770dd29129b826e39552330104c8d71e6cc3a3014dd2f61b54153af51b0438d447ee939f9e3c13bb8b00a37dea6a068f6c9d27e848b1be7a1eeeb3ee50b78036fba95ae46948ca5b13f356ea24db10f60dc09e4b8bad8f766b668ef72524432080a0ce00ed676d6d5e354984b1078520412525848156d06f0652469f95791baa3d9a798ae537094f76f976faecd5c9ce0c930a75910c63dacf63485cb4b5e7bdbcf4d80e74037eaa1a8fe4b52930bec6be99cf6ac88cf5878dbf6859d456a95dbc34654eec425de84ca2a535d517403a9aada827e7d0093ecfc97ed056a7652825e9a45cb2dcb",
            cipher3072: "0351794ac968e26863bfa67aa4d602c725b79ca9a4cd907a9e03c7575b975bfd99fa491b5bc3f93e1eac5b48d95090e10a29d9e4edce709c74886ee2d5067bcabab044e239cb4c23e1ffa8a8666fbdc706ecf49225697fb6f1a095e20dcca49090548d9fd0b8533b090823a76ce6c8c8a139a20b3e930a8d2ef8d868fd92c086c06a86c172e40e76f9920a6de6ab2fbff2cbe029b685dbc20da94e84442050b0128200446bf227eca935e1bfa8c89ec3454ea3a82cc792a2512d8513f2ddaf172e35e735ad69a5f892ad0c216e84ea9e92129d8272db269173cbc525e61fdfa5533e2e69a4670ed95f4958c684476c208002667fc7f687260eb54d9cea88bbfeb7b6d7aa640cf0ad0af22ecae17034c762bf832a9e8ef090926c5ad4fe6a15b6e5ef69da001bb7fbc608bc024bcf38e157dbb57974169bdf302ec177e48d15a1d0c919d9b8862cd91d454a96df1c720561928e282b9e922d0d8218d65b74bb740cb7cf7455e97a5e6bba07424382c31c37549d7f29bf7e2e23093ee861dce0ef",
            cipher4096: "7aa5fee8dd85b6fc0c75c86d72fe6c742ecb062a036bbd3796af044378669c2162f6f9c9470e1dc8edad8a41de37411b21c865c0d04a2a4a8cbae941258aecc1bc436e96ab7d66aa1b866e9b3018a56366eaefaf92a1af51d5a901900739eecf07f05748b76565e386efcc8a717f39cf0a163dbfd7b1b02d78f96c4688143a80ea589df83c78440f5c53a1a79fa7265f5e1c15cf8348b8b7abbfc1739a9fdc8a30e25c2081b44437935fdcd19682cff42627b223d796d1cd3437fb12aeb990bf5dee03ec6fe8f0634dc0545d0390facc7fea02b5609f0b37e4bc5f2a5e26868ac3042fac5589457b482bf1c144c239e2a96bd80a813e67d36b4e43cb89450289ab3fd7d377cdcaf9b40811ecc5aa3704086dce9a893d1b19d9f957dcfc283d0ff1a4bdd7f3351314bd5e10a22b2a469615feab35e9966e758c5c2742c35d42659533fbf50693dd1efccaf1787de3c7f66b8c0df90754ca851caf2341b9a7004a7eb8e34cf232a6bc0e993db274107d4d734bb996803a4b335e1ce32d0453450a6fa871430827fd49123849993f421084c60880e3b6e4d33771a1bb255535616544cf4c016c416cd8b9b92c3ed61214972e86a901560c1721fef866ea7044a2c89cc2cba85fb25df521daa90680fb52c2a0baeac9d5942c851fbf5f1e88d522e759aa342d15be1b72f9815c0debd081e9881fba247dd6858890fdedc8838e9448",
            mda: .SHA2_256),
        testStruct(
            msg: "313233343030",
            cipher2048: "26aa8e7931ed624bfd4077e3b83ec08de080483a61641e877f493fb7d0ae4dfebd4f05612a2e4869d20d440a64e928b13daa3b79da2ed674b99421df7e7f625a22b1c71136da27db699d3dd96e3364ee0cd2123ab6808930c6bc28a5dc307880d1ab4b03bcd6178a81b8ad52aafffbab387d40352dfea526abedca016c87e9e56ccc4c88e80f579da015b979bcdd88618b2a32ce072918b2e223535359f1ce4eaba5e692e6296b2140dc2304092ebd6f136a48092b3849082b57e70c93b54db55045dd6094ef3d2cfa8bc9e2fd2b1bbe0c7c603ad38d3f40c9eac8ae5e28cbbb031c38d93d3b2541d94eab3a1e8992a444ee4ce7b8d08c0b9a4f623d32fcba14",
            cipher3072: "85186e5bd121796c604ceeaebe2f12fe87f41f502c2622f0ac8599428f556f7ddba82355e65dde44fe1691b7901fcf6ed83fb837c1f7ca549b2565da1a249dc717c245a9c6362c8e831ee4156dfdec6d9e19ee500243edf4419d152c643360e35935d88a0364b28038cbab30d23f6571053be99e0e405538c54a71c4483caa328a8a49b1e9a5ab0172d429b5635fa7cc11f5703bb95536d218bdb4ed555a2b1b71c717bd65e3607dfd7e7cfc1fa7f42e72a5daae3e6bd694a4a6194bce970cf102bafc5573b8de18544080db3e89a753b9245ed9cf7a17282017c8276bfbe737bf0d802a7d2e9a9fb5f373f9760708211f9b7a99d3dce0becfa77c96b1f5fe1c4ae8cb2b4f7c741e90e4bd2fd1b93648252e4576b5670d51e86068497ddf162a80dbc2a16b73e16e3661f31a8f2fdbb66764a70a1cec5e0e247e38f3fe95949a5742b1987280ba9d4afe69cd00fe10feee87b9d0b40a2e94fc042a4a51474d7e162a1e7261b2791f8af2af6978bb87ea1059553af71777fd04fb92c4fecab972",
            cipher4096: "0b3d6f1a7949a05d472e0909c4667374a87e291ca8065786829b26702f2b979ed440a037abd310da6c0eacf0c01f5b2b082d00ea043e9bd403af238a0909ad8302deb3514cf7710d6a7777838675fd61e698ff09d03821046caa15848cf3c8b1e70fc497e2c8d3639dfaae1bebc52b68c24b54f3f1c4dbd8691d05867a818b0364512d6096ee6a49de7aa7f17148de1f5036af74213df39be1639a1b22640a693163af2e061073e28e1b20f32ce15cabd1005ed66d4d4ccfb50f94c6a34357989c1e13350fb25eb75e5004dfc311babf755d0c007fddf9398aa9c2761b5415c3a1c25e1d0c883187ee41c669337f3b69e131f87c68360ebcf4ac53cdd7101c71fcb1aeead812b06efaa514fecc8ebbc4b339a3f8e9fecd720c2d9019885346d4b483418ddde6f99c6cfe67500ac3ef5c064ab2fd96bf3372ece582c02e3dccefe5ea8cd82a79e7922075db696c5aa712243566fb820bec894ff96d3e844aeef4416b08e023fe48570f05203cf48054601a227ed3fc81fab7e54090864c110d7c0333299839675ce029436cf78266441fb910ef46101c3378cf7d322b696beed85d68a74fc5ad8bf65d212996774a80a68c7d017bdcffbb3f6194c2625e5937d3a004684d3a30b4c31c7fe4c05718182bde18a444dc2467d87bfa9fd64fbf5d31919d4f33f6f5721bea0afde9f47170fc8a2f45e17f4711971572873344a14372",
            mda: .SHA2_256,
            label: "000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f"),
    ]

    func test1() throws {
        let privKey2048 = try RSAPrivateKey(pem: privPem2048, format: .X509)
        let pubKey2048 = RSAPublicKey(privKey2048.n, privKey2048.e)
        let privKey3072 = try RSAPrivateKey(pem: privPem3072, format: .X509)
        let pubKey3072 = RSAPublicKey(privKey3072.n, privKey3072.e)
        let privKey4096 = try RSAPrivateKey(pem: privPem4096, format: .X509)
        let pubKey4096 = RSAPublicKey(privKey4096.n, privKey4096.e)
        for t in tests {
            let label = Utilities.hex2bytes(t.label)
            let cipher2048 = Utilities.hex2bytes(t.cipher2048)
            let msg2048 = try privKey2048.decryptOAEP(cipher: cipher2048, mda: t.mda, label: label)
            XCTAssertEqual(msg2048, Utilities.hex2bytes(t.msg))
            let cipher1 = try pubKey2048.encryptOAEP(message: Utilities.hex2bytes(t.msg), mda: t.mda, label: label)
            let msg1 = try privKey2048.decryptOAEP(cipher: cipher1, mda: t.mda, label: label)
            XCTAssertEqual(msg1, msg2048)

            let cipher3072 = Utilities.hex2bytes(t.cipher3072)
            let msg3072 = try privKey3072.decryptOAEP(cipher: cipher3072, mda: t.mda, label: label)
            XCTAssertEqual(msg2048, Utilities.hex2bytes(t.msg))
            let cipher2 = try pubKey3072.encryptOAEP(message: Utilities.hex2bytes(t.msg), mda: t.mda, label: label)
            let msg2 = try privKey3072.decryptOAEP(cipher: cipher2, mda: t.mda, label: label)
            XCTAssertEqual(msg2, msg3072)

            let cipher4096 = Utilities.hex2bytes(t.cipher4096)
            let msg4096 = try privKey4096.decryptOAEP(cipher: cipher4096, mda: t.mda, label: label)
            XCTAssertEqual(msg4096, Utilities.hex2bytes(t.msg))
            let cipher3 = try pubKey4096.encryptOAEP(message: Utilities.hex2bytes(t.msg), mda: t.mda, label: label)
            let msg3 = try privKey4096.decryptOAEP(cipher: cipher3, mda: t.mda, label: label)
            XCTAssertEqual(msg3, msg4096)
        }
    }

}
